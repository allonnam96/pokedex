{"ast":null,"code":"import { LOAD_ITEMS, REMOVE_ITEM, ADD_ITEM } from './items';\nimport { ValidationError } from '../utils/validationError';\nconst LOAD = 'pokemon/LOAD';\nconst LOAD_TYPES = 'pokemon/LOAD_TYPES';\nconst ADD_ONE = 'pokemon/ADD_ONE';\n\nconst load = list => ({\n  type: LOAD,\n  list\n});\n\nconst loadTypes = types => ({\n  type: LOAD_TYPES,\n  types\n});\n\nconst addOnePokemon = pokemon => ({\n  type: ADD_ONE,\n  pokemon\n});\n\nexport const getPokemon = () => async dispatch => {\n  const response = await fetch(`/api/pokemon`);\n\n  if (response.ok) {\n    const list = await response.json();\n    dispatch(load(list));\n  }\n};\nexport const getPokemonTypes = () => async dispatch => {\n  const response = await fetch(`/api/pokemon/types`);\n\n  if (response.ok) {\n    const types = await response.json();\n    dispatch(loadTypes(types));\n  }\n};\nexport const getOnePokemon = id => async dispatch => {\n  const response = await fetch(`/api/pokemon/${id}`);\n\n  if (response.ok) {\n    const pokemon = await response.json();\n    dispatch(addOnePokemon(pokemon));\n  }\n};\nexport const createPokemon = data => async dispatch => {\n  try {\n    const response = await fetch(`/api/pokemon`, {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    });\n\n    if (!response.ok) {\n      let error;\n\n      if (response.status === 422) {\n        error = await response.json();\n        throw new ValidationError(error.errors, response.statusText);\n      } else {\n        let errorJSON;\n        error = await response.text();\n\n        try {\n          // Check if the error is JSON, i.e., from the Pokemon server. If so,\n          // don't throw error yet or it will be caught by the following catch\n          errorJSON = JSON.parse(error);\n        } catch {\n          // Case if server could not be reached\n          throw new Error(error);\n        }\n\n        throw new Error(`${errorJSON.title}: ${errorJSON.message}`);\n      }\n    }\n\n    const pokemon = await response.json();\n    dispatch(addOnePokemon(pokemon));\n    return pokemon;\n  } catch (error) {\n    throw error;\n  }\n};\nexport const updatePokemon = data => async dispatch => {\n  const response = await fetch(`/api/pokemon/${data.id}`, {\n    method: 'put',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(data)\n  });\n\n  if (response.ok) {\n    const pokemon = await response.json();\n    dispatch(addOnePokemon(pokemon));\n    return pokemon;\n  }\n};\nconst initialState = {\n  list: [],\n  types: []\n};\n\nconst sortList = list => {\n  return list.sort((pokemonA, pokemonB) => {\n    return pokemonA.number - pokemonB.number;\n  }).map(pokemon => pokemon.id);\n};\n\nconst pokemonReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case LOAD:\n      const allPokemon = {};\n      action.list.forEach(pokemon => {\n        allPokemon[pokemon.id] = pokemon;\n      });\n      return { ...allPokemon,\n        ...state,\n        list: sortList(action.list)\n      };\n\n    case LOAD_TYPES:\n      return { ...state,\n        types: action.types\n      };\n\n    case ADD_ONE:\n      if (!state[action.pokemon.id]) {\n        const newState = { ...state,\n          [action.pokemon.id]: action.pokemon\n        };\n        const pokemonList = newState.list.map(id => newState[id]);\n        pokemonList.push(action.pokemon);\n        newState.list = sortList(pokemonList);\n        return newState;\n      }\n\n      return { ...state,\n        [action.pokemon.id]: { ...state[action.pokemon.id],\n          ...action.pokemon\n        }\n      };\n\n    case LOAD_ITEMS:\n      return { ...state,\n        [action.pokemonId]: { ...state[action.pokemonId],\n          items: action.items.map(item => item.id)\n        }\n      };\n\n    case REMOVE_ITEM:\n      return { ...state,\n        [action.pokemonId]: { ...state[action.pokemonId],\n          items: state[action.pokemonId].items.filter(itemId => itemId !== action.itemId)\n        }\n      };\n\n    case ADD_ITEM:\n      console.log(action.item);\n      return { ...state,\n        [action.item.pokemonId]: { ...state[action.item.pokemonId],\n          items: [...state[action.item.pokemonId].items, action.item.id]\n        }\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport default pokemonReducer;","map":{"version":3,"names":["LOAD_ITEMS","REMOVE_ITEM","ADD_ITEM","ValidationError","LOAD","LOAD_TYPES","ADD_ONE","load","list","type","loadTypes","types","addOnePokemon","pokemon","getPokemon","dispatch","response","fetch","ok","json","getPokemonTypes","getOnePokemon","id","createPokemon","data","method","headers","body","JSON","stringify","error","status","errors","statusText","errorJSON","text","parse","Error","title","message","updatePokemon","initialState","sortList","sort","pokemonA","pokemonB","number","map","pokemonReducer","state","action","allPokemon","forEach","newState","pokemonList","push","pokemonId","items","item","filter","itemId","console","log"],"sources":["/Users/allonnam/Downloads/pokedex full/backend/frontend/src/store/pokemon.js"],"sourcesContent":["import { LOAD_ITEMS, REMOVE_ITEM, ADD_ITEM } from './items';\nimport { ValidationError } from '../utils/validationError';\n\nconst LOAD = 'pokemon/LOAD';\nconst LOAD_TYPES = 'pokemon/LOAD_TYPES';\nconst ADD_ONE = 'pokemon/ADD_ONE';\n\nconst load = list => ({\n  type: LOAD,\n  list\n});\n\nconst loadTypes = types => ({\n  type: LOAD_TYPES,\n  types\n});\n\nconst addOnePokemon = pokemon => ({\n  type: ADD_ONE,\n  pokemon\n});\n\nexport const getPokemon = () => async dispatch => {\n  const response = await fetch(`/api/pokemon`);\n\n  if (response.ok) {\n    const list = await response.json();\n    dispatch(load(list));\n  }\n};\n\nexport const getPokemonTypes = () => async dispatch => {\n  const response = await fetch(`/api/pokemon/types`);\n\n  if (response.ok) {\n    const types = await response.json();\n    dispatch(loadTypes(types));\n  }\n};\n\nexport const getOnePokemon = id => async dispatch => {\n  const response = await fetch(`/api/pokemon/${id}`);\n\n  if (response.ok) {\n    const pokemon = await response.json();\n    dispatch(addOnePokemon(pokemon));\n  }\n};\n\nexport const createPokemon = data => async dispatch => {\n  try {\n    const response = await fetch(`/api/pokemon`, {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    });\n\n    if (!response.ok) {\n      let error;\n      if (response.status === 422) {\n        error = await response.json();\n        throw new ValidationError(error.errors, response.statusText);\n      } \n      else {\n        let errorJSON;\n        error = await response.text();\n        try {\n          // Check if the error is JSON, i.e., from the Pokemon server. If so,\n          // don't throw error yet or it will be caught by the following catch\n          errorJSON = JSON.parse(error);\n        }\n        catch {\n          // Case if server could not be reached\n          throw new Error(error);\n        }\n        throw new Error(`${errorJSON.title}: ${errorJSON.message}`);\n      }\n    } \n\n    const pokemon = await response.json();\n    dispatch(addOnePokemon(pokemon));\n    return pokemon;\n  } \n  catch (error) {\n    throw error;\n  }\n};\n\nexport const updatePokemon = data => async dispatch => {\n  const response = await fetch(`/api/pokemon/${data.id}`, {\n    method: 'put',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(data)\n  });\n  \n  if (response.ok) {\n    const pokemon = await response.json();\n    dispatch(addOnePokemon(pokemon));\n    return pokemon;\n  }\n};\n\nconst initialState = {\n  list: [],\n  types: []\n};\n\nconst sortList = (list) => {\n  return list.sort((pokemonA, pokemonB) => {\n    return pokemonA.number - pokemonB.number;\n  }).map((pokemon) => pokemon.id);\n};\n\nconst pokemonReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case LOAD: \n      const allPokemon = {};\n      action.list.forEach(pokemon => {\n        allPokemon[pokemon.id] = pokemon;\n      });\n      return {\n        ...allPokemon,\n        ...state,\n        list: sortList(action.list)\n      };\n    case LOAD_TYPES: \n      return {\n        ...state,\n        types: action.types\n      };\n    case ADD_ONE: \n      if (!state[action.pokemon.id]) {\n        const newState = {\n          ...state,\n          [action.pokemon.id]: action.pokemon\n        };\n        const pokemonList = newState.list.map(id => newState[id]);\n        pokemonList.push(action.pokemon);\n        newState.list = sortList(pokemonList);\n        return newState;\n      }\n      return {\n        ...state,\n        [action.pokemon.id]: {\n          ...state[action.pokemon.id],\n          ...action.pokemon\n        }\n      };\n    case LOAD_ITEMS: \n      return {\n        ...state,\n        [action.pokemonId]: {\n          ...state[action.pokemonId],\n          items: action.items.map(item => item.id)\n        }\n      };\n    case REMOVE_ITEM:\n      return {\n        ...state,\n        [action.pokemonId]: {\n          ...state[action.pokemonId],\n          items: state[action.pokemonId].items.filter(\n            (itemId) => itemId !== action.itemId\n          )\n        }\n      };\n    case ADD_ITEM:\n      console.log(action.item);\n      return {\n        ...state,\n        [action.item.pokemonId]: {\n          ...state[action.item.pokemonId],\n          items: [...state[action.item.pokemonId].items, action.item.id]\n        }\n      };\n    default:\n      return state;\n  }\n}\n\nexport default pokemonReducer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}